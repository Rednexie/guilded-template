"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ServerEventHandler = void 0;
const constants_1 = require("../../constants");
const util_1 = require("../../util");
const GatewayEventHandler_1 = require("./GatewayEventHandler");
class ServerEventHandler extends GatewayEventHandler_1.GatewayEventHandler {
    serverRolesUpdated(data) {
        const oldMembers = [];
        // update members cache
        for (const m of data.d.memberRoleIds) {
            const member = this.client.members.cache.get((0, util_1.buildMemberKey)(data.d.serverId, m.userId));
            if (member) {
                oldMembers.push(member._clone());
                member._update({ roleIds: m.roleIds });
            }
        }
        return this.client.emit(constants_1.constants.clientEvents.ROLES_UPATED, { serverId: data.d.serverId, members: data.d.memberRoleIds }, oldMembers);
    }
}
exports.ServerEventHandler = ServerEventHandler;
//# sourceMappingURL=ServerEventHandler.js.map